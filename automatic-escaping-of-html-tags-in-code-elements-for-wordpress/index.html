<!doctype html>
<html class="no-js" lang="en">
  
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Automatic Escaping of HTML Tags in Code Elements for Wordpress</title>
    <link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
    
    <link href="/stylesheets/app.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/style.css" media="screen" rel="stylesheet" type="text/css" />
<link href="/stylesheets/highlight/monokai.css" media="screen" rel="stylesheet" type="text/css" />
    <script src="/javascripts/modernizr.js" type="text/javascript"></script>
  </head>
      
  <body class="blog automatic-escaping-of-html-tags-in-code-elements-for-wordpress automatic-escaping-of-html-tags-in-code-elements-for-wordpress_index">
      <nav class="top-bar" data-topbar="">
    <div id="social">
      <a href="https://plus.google.com/+SourceyDevel"><i class="fi-social-google-plus large"></i></a>
      <a href="https://facebook.com/sourceydevel"><i class="fi-social-facebook large"></i></a>
      <a href="https://twitter.com/sourceydevel"><i class="fi-social-twitter large"></i></a>
      <a href="https://github.com/sourcey"><i class="fi-social-github large"></i></a>    
    </div>
      
    <ul class="title-area">
      <li class="name"></li>
      <li class="toggle-topbar menu-icon"><a href="" class="left"><!--Menu--></a></li>
    </ul>
    
    <section class="top-bar-section" style="left: 0%;">      
      <ul class="left">
        <li class="has-dropdown not-click"><a href="/">Menu</a>
          <ul class="dropdown"><li class="title back js-generated"><h5><a href="javascript:void(0)">Back</a></h5></li>
            <li><label>Wicked</label></li>
            <li class="has-dropdown not-click"><a href="/#projects">Projects</a>
              <ul class="dropdown"><li class="title back js-generated"><h5><a href="javascript:void(0)">Back</a></h5></li>
                <li><label>Projects</label></li>
                <li><a href="/libsourcey">LibSourcey</a></li>
                <li><a href="/anionu">Anionu</a></li>
                <li><a href="/symple">Symple</a></li>
                <li><a href="/mesh">Mesh</a></li>
                <li><a href="/pacman">Pacman</a></li>
              </ul>
            </li>
            <li class="divider"></li>
            <li><a href="/#blog">Blog</a></li>
            <li><a href="/archives">Archives</a></li>
            <li><a href="/feed.xml">Feed</a></li>
            <li class="divider"></li>
            <li><a href="mailto:hello@sourcey.com">Contact</a></li>
          </ul>
        </li>
        <li class="divider"></li>
      </ul>
    </section></nav>
    
    <header id="header">
      <h1 id="logo">
        <a title="Sourcey" rel="home" href="http://sourcey.com"><img height="150" width="150" title="Sourcey" alt="Sourcey" src="/images/logo-250.png" /></a>
      </h1>
      <!--<h2 class="site-description">Open Source Developer Collective</h2>-->
    </header>    
    <div id="main" role="main">
      <div id="rotate-article">
        
          <a class="next" href="/dynamically-rendering-ajax-pinterest-buttons/">next article &rarr;</a>
        
        
          <a class="prev" href="/generating-website-thumbnails-in-rails-4-using-dragonfly-and-wkhtmltoimage/">&larr; previous article</a>
        
      </div>
      <h1 id="automatic-escaping-of-html-tags-in-code-elements-for-wordpress">Automatic Escaping of HTML Tags in Code Elements for Wordpress</h1>

<p>For those of you who are using wordpress and don't want to manually escape or mangle HTML tags inside your "code" elements, just add the below code to your functions.php to save you from a hair-pulling experience. You can also escape code in "pre" or other elements by modifying the regex string.</p>

<pre class="highlight php">// Escape HTML tags in post content
add_filter('the_content', 'escape_code_fragments');

// Escape HTML tags in comments
add_filter('pre_comment_content', 'escape_code_fragments');

function escape_code_fragments($source) {
  $encoded = preg_replace_callback('/<span class="nt">&lt;code</span><span class="err">(.*?)</span><span class="nt">&gt;</span>(.*?)<span class="err">&lt;</span>\/code&gt;/ims',
  create_function(
    '$matches',
    '$matches[2] = preg_replace(
        array("/^[\r|\n]+/i", "/[\r|\n]+$/i"), "",
        $matches[2]);
      return "<span class="nt">&lt;code</span><span class="err">"</span> <span class="err">.</span> <span class="err">$</span><span class="na">matches</span><span class="err">[</span><span class="na">1</span><span class="err">]</span> <span class="err">.</span> <span class="err">"</span><span class="nt">&gt;</span>" . esc_html( $matches[2] ) . "`";'
  ),
  $source);

  if ($encoded)
    return $encoded;
  else
    return $source;
}
</pre>
    
      
      <ul class="social-buttons">
        <li>
          <a href="http://twitter.com/share" class="socialite twitter-share" data-text="Automatic Escaping of HTML Tags in Code Elements for Wordpress" data-url="http://sourcey.com/automatic-escaping-of-html-tags-in-code-elements-for-wordpress/" data-count="vertical" rel="nofollow" target="_blank"><span class="vhidden">Share on Twitter</span></a>
        </li>
        <li>
          <a href="https://plus.google.com/share?url=http://sourcey.com/automatic-escaping-of-html-tags-in-code-elements-for-wordpress/" class="socialite googleplus-one" data-size="tall" data-href="http://sourcey.com/automatic-escaping-of-html-tags-in-code-elements-for-wordpress/" rel="nofollow" target="_blank"><span class="vhidden">Share on Google+</span></a>
        </li>
        <li>
          <a href="http://www.facebook.com/sharer.php?u=http://sourcey.com/automatic-escaping-of-html-tags-in-code-elements-for-wordpress/&amp;t=Automatic Escaping of HTML Tags in Code Elements for Wordpress" class="socialite facebook-like" data-href="http://sourcey.com/automatic-escaping-of-html-tags-in-code-elements-for-wordpress/" data-send="false" data-layout="box_count" data-width="60" data-show-faces="false" rel="nofollow" target="_blank"><span class="vhidden">Share on Facebook</span></a>
        </li>
        <li>
          <a href="http://www.linkedin.com/shareArticle?mini=true&amp;url=http://sourcey.com/automatic-escaping-of-html-tags-in-code-elements-for-wordpress/&amp;title=Automatic Escaping of HTML Tags in Code Elements for Wordpress" class="socialite linkedin-share" data-url="http://sourcey.com/automatic-escaping-of-html-tags-in-code-elements-for-wordpress/" data-counter="top" rel="nofollow" target="_blank"><span class="vhidden">Share on LinkedIn</span></a>
        </li>
      </ul>        
      <div class="meta">
        Posted on <time class="updated" datetime="Mar 15 2014">Mar 15 2014</time> by 
        
          <a rel="author external" href="https://plus.google.com/+KamLow">Kam Low</a>
        . Tagged: php, programming, regex, wordpress.
      </div>       
      
      <div id="disqus_thread"></div>
      <script type="text/javascript">
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'sourcey'; // required: replace example with your forum shortname

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script>
      <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
      <a href="http://disqus.com" rel="nofollow" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>    
    </div>
        
    <!--
    <div style="text-align: center">
    <script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>  -->
    <!-- Sourcey Small H --><!--
    <ins class="adsbygoogle"
         style="display:inline-block;width:468px;height:60px;margin: 30px auto 15px;"
         data-ad-client="ca-pub-1397369873900370"
         data-ad-slot="8968503286"></ins>
    <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
    </div>
    -->

    <footer id="footer">
      <p>
        As with all business minded artists, we have fought the inevitable battle of conformity vs expression, and have emerged victorious with sanity intact to plunder the digiverse in search of new and interesting challenges. For more information, or a quote, drop us an email and tell us what you're working on.
      </p>
      <!--
      <p>                     
        Our Kung Fu includes and is not limited to: C++, Ruby, Python, Java, Php, JavaScript, Node.js, ActionScript, HTML, CSS and Photoshop.
      <p>  
       -->      	  
      <p>
      &copy;2014 Sourcey     
      <p>  
    </footer>
      
    <script src="/javascripts/all.js" type="text/javascript"></script>
  </body>
</html>
