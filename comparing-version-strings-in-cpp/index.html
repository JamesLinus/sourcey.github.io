<!doctype html> <html class=no-js lang=en> <head> <title>Comparing Version Strings in C++</title> <meta charset=utf-8 /> <meta name=viewport content="width=device-width, initial-scale=1.0"/> <meta name=google-site-verification content=lC7-hHwqtiRqo7YTHc1fJ6t8ie-Hs7J4o5u3XRIF9Vw /> <link rel=alternate type="application/atom+xml" title="Atom Feed" href="/feed.xml"/> <link href="/stylesheets/app.css" media=screen rel=stylesheet /> <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-836728-7', 'sourcey.com');
      ga('send', 'pageview');
    </script> </head> <body class="blog comparing-version-strings-in-cpp comparing-version-strings-in-cpp_index"> <nav class=top-bar data-topbar=""> <div id=social> <a href="https://plus.google.com/+SourceyDevel"><i class="fi-social-google-plus large"></i></a> <a href="https://facebook.com/sourceydevel"><i class="fi-social-facebook large"></i></a> <a href="https://twitter.com/sourceydevel"><i class="fi-social-twitter large"></i></a> <a href="https://github.com/sourcey"><i class="fi-social-github large"></i></a> </div> <ul class=title-area> <li class=name></li> <li class="toggle-topbar menu-icon"><a href="" class=left></a></li> </ul> <section class=top-bar-section style="left: 0%;"> <ul class=left> <li class="has-dropdown not-click"><a href="/">Menu</a> <ul class=dropdown><li class="title back js-generated"><h5><a href="javascript:void(0)">Back</a></h5></li> <li><label>Wicked</label></li> <li class="has-dropdown not-click"><a href="/#projects">Projects</a> <ul class=dropdown><li class="title back js-generated"><h5><a href="javascript:void(0)">Back</a></h5></li> <li><label>Projects</label></li> <li><a href="/libsourcey">LibSourcey</a></li> <li><a href="/anionu">Anionu</a></li> <li><a href="/symple">Symple</a></li> <li><a href="/mesh">Mesh</a></li> <li><a href="/pacm">Pacm</a></li> </ul> </li> <li class=divider></li> <li><a href="/#blog">Blog</a></li> <li><a href="/archives">Archives</a></li> <li><a href="/feed.xml">Feed</a></li> <li class=divider></li> <li><a href="mailto:hello@sourcey.com">Contact</a></li> </ul> </li> <li class=divider></li> </ul> </section></nav> <header id=header> <h1 id=logo> <a title=Sourcey rel=home href="//sourcey.com"><img height=150 width=150 title=Sourcey alt=Sourcey src="/images/logo-250.png"/></a> </h1> </header> <div id=main role=main> <div id=rotate-article> <a class=prev href="/agile-peer-code-reviews-with-codebrag/">&larr; previous article</a> </div> <h1 id=comparing-version-strings-in-c>Comparing Version Strings in C++</h1> <p>If you're building any kind of version management system in C++, such as a package manager or plugin system, then you'll need to be able to maniulate, compare and print version strings. The <code>Version</code> structure below is extracted from <a href="/pacm">pacm</a>, and does exactly that:</p> <pre class="highlight cpp"><span class="cp">#include &lt;cstdio&gt;
#include &lt;string&gt;
#include &lt;iostream&gt;
</span>
<span class="k">struct</span> <span class="n">Version</span>
<span class="p">{</span>
	<span class="kt">int</span> <span class="n">major</span><span class="p">,</span> <span class="n">minor</span><span class="p">,</span> <span class="n">revision</span><span class="p">,</span> <span class="n">build</span><span class="p">;</span>

	<span class="n">Version</span><span class="p">(</span><span class="k">const</span> <span class="n">std</span><span class="o">::</span><span class="n">string</span><span class="o">&amp;</span> <span class="n">version</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="n">std</span><span class="o">::</span><span class="n">sscanf</span><span class="p">(</span><span class="n">version</span><span class="p">.</span><span class="n">c_str</span><span class="p">(),</span> <span class="s">"%d.%d.%d.%d"</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">major</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">minor</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">revision</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">build</span><span class="p">);</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">major</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">major</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">minor</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">minor</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">revision</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">revision</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">build</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="n">build</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">bool</span> <span class="k">operator</span> <span class="o">&lt;</span> <span class="p">(</span><span class="k">const</span> <span class="n">Version</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">major</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">major</span><span class="p">)</span>
			<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">minor</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">minor</span><span class="p">)</span>
			<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">revision</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">revision</span><span class="p">)</span>
			<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
		<span class="k">if</span> <span class="p">(</span><span class="n">build</span> <span class="o">&lt;</span> <span class="n">other</span><span class="p">.</span><span class="n">build</span><span class="p">)</span>
			<span class="k">return</span> <span class="nb">true</span><span class="p">;</span>
		<span class="k">return</span> <span class="nb">false</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="n">bool</span> <span class="k">operator</span> <span class="o">==</span> <span class="p">(</span><span class="k">const</span> <span class="n">Version</span><span class="o">&amp;</span> <span class="n">other</span><span class="p">)</span>
	<span class="p">{</span>
		<span class="k">return</span> <span class="n">major</span> <span class="o">==</span> <span class="n">other</span><span class="p">.</span><span class="n">major</span> 
			<span class="o">&amp;&amp;</span> <span class="n">minor</span> <span class="o">==</span> <span class="n">other</span><span class="p">.</span><span class="n">minor</span> 
			<span class="o">&amp;&amp;</span> <span class="n">revision</span> <span class="o">==</span> <span class="n">other</span><span class="p">.</span><span class="n">revision</span> 
			<span class="o">&amp;&amp;</span> <span class="n">build</span> <span class="o">==</span> <span class="n">other</span><span class="p">.</span><span class="n">build</span><span class="p">;</span>
	<span class="p">}</span>

	<span class="k">friend</span> <span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="k">operator</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">std</span><span class="o">::</span><span class="n">ostream</span><span class="o">&amp;</span> <span class="n">stream</span><span class="p">,</span> <span class="k">const</span> <span class="n">Version</span><span class="o">&amp;</span> <span class="n">ver</span><span class="p">)</span> 
	<span class="p">{</span>
		<span class="n">stream</span> <span class="o">&lt;&lt;</span> <span class="n">ver</span><span class="p">.</span><span class="n">major</span><span class="p">;</span>
		<span class="n">stream</span> <span class="o">&lt;&lt;</span> <span class="sc">'.'</span><span class="p">;</span>
		<span class="n">stream</span> <span class="o">&lt;&lt;</span> <span class="n">ver</span><span class="p">.</span><span class="n">minor</span><span class="p">;</span>
		<span class="n">stream</span> <span class="o">&lt;&lt;</span> <span class="sc">'.'</span><span class="p">;</span>
		<span class="n">stream</span> <span class="o">&lt;&lt;</span> <span class="n">ver</span><span class="p">.</span><span class="n">revision</span><span class="p">;</span>
		<span class="n">stream</span> <span class="o">&lt;&lt;</span> <span class="sc">'.'</span><span class="p">;</span>
		<span class="n">stream</span> <span class="o">&lt;&lt;</span> <span class="n">ver</span><span class="p">.</span><span class="n">build</span><span class="p">;</span>
		<span class="k">return</span> <span class="n">stream</span><span class="p">;</span>
	<span class="p">}</span>
<span class="p">};</span>
</pre> <p>Example usage:</p> <pre class="highlight cpp"><span class="kt">void</span> <span class="nf">testVersionStringComparison</span><span class="p">()</span> 
<span class="p">{</span>
	<span class="n">assert</span><span class="p">((</span><span class="n">Version</span><span class="p">(</span><span class="s">"3.7.8.0"</span><span class="p">)</span> <span class="o">==</span> <span class="n">Version</span><span class="p">(</span><span class="s">"3.7.8.0"</span><span class="p">))</span> <span class="o">==</span> <span class="nb">true</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">((</span><span class="n">Version</span><span class="p">(</span><span class="s">"3.7.8.0"</span><span class="p">)</span> <span class="o">==</span> <span class="n">Version</span><span class="p">(</span><span class="s">"3.7.8"</span><span class="p">))</span> <span class="o">==</span> <span class="nb">true</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">((</span><span class="n">Version</span><span class="p">(</span><span class="s">"3.7.8.0"</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Version</span><span class="p">(</span><span class="s">"3.7.8"</span><span class="p">))</span> <span class="o">==</span> <span class="nb">false</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">((</span><span class="n">Version</span><span class="p">(</span><span class="s">"3.7.9"</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Version</span><span class="p">(</span><span class="s">"3.7.8"</span><span class="p">))</span> <span class="o">==</span> <span class="nb">false</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">((</span><span class="n">Version</span><span class="p">(</span><span class="s">"3"</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Version</span><span class="p">(</span><span class="s">"3.7.9"</span><span class="p">))</span> <span class="o">==</span> <span class="nb">true</span><span class="p">);</span>
	<span class="n">assert</span><span class="p">((</span><span class="n">Version</span><span class="p">(</span><span class="s">"1.7.9"</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">Version</span><span class="p">(</span><span class="s">"3.1"</span><span class="p">))</span> <span class="o">==</span> <span class="nb">true</span><span class="p">);</span>
	
	<span class="n">std</span><span class="o">::</span><span class="n">cout</span> <span class="o">&lt;&lt;</span> <span class="s">"Printing version (3.7.8.0): "</span> <span class="o">&lt;&lt;</span> <span class="n">Version</span><span class="p">(</span><span class="s">"3.7.8.0"</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">endl</span><span class="p">;</span>
<span class="p">}</span>
</pre> <ul class=social-buttons> <li> <a href="//twitter.com/share" class="socialite twitter-share" data-text="Comparing Version Strings in C++" data-url="http://sourcey.com/comparing-version-strings-in-cpp/" data-count=vertical rel=nofollow target=_blank><span class=vhidden>Share on Twitter</span></a> </li> <li> <a href="https://plus.google.com/share?url=http://sourcey.com/comparing-version-strings-in-cpp/" class="socialite googleplus-one" data-size=tall data-href="//sourcey.com/comparing-version-strings-in-cpp/" rel=nofollow target=_blank><span class=vhidden>Share on Google+</span></a> </li> <li> <a href="//www.facebook.com/sharer.php?u=http://sourcey.com/comparing-version-strings-in-cpp/&amp;t=Comparing Version Strings in C++" class="socialite facebook-like" data-href="http://sourcey.com/comparing-version-strings-in-cpp/" data-send=false data-layout=box_count data-width=60 data-show-faces=false rel=nofollow target=_blank><span class=vhidden>Share on Facebook</span></a> </li> <li> <a href="//www.linkedin.com/shareArticle?mini=true&amp;url=http://sourcey.com/comparing-version-strings-in-cpp/&amp;title=Comparing Version Strings in C++" class="socialite linkedin-share" data-url="http://sourcey.com/comparing-version-strings-in-cpp/" data-counter=top rel=nofollow target=_blank><span class=vhidden>Share on LinkedIn</span></a> </li> </ul> <div class=meta> Posted on <time class=updated datetime="May 22 2014">May 22 2014</time> by <a rel="author external" href="https://plus.google.com/+KamLow">Kam Low</a> . Tagged: code, cpp. </div> <div id=disqus_thread></div> <script>
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'sourcey'; // required: replace example with your forum shortname

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();
      </script> <noscript>Please enable JavaScript to view the <a href="//disqus.com/?ref_noscript" rel=nofollow>comments powered by Disqus.</a></noscript> <a href="//disqus.com" rel=nofollow class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a> </div> <footer id=footer> <p> As with all business minded artists, we have fought the inevitable battle of conformity vs expression, and have emerged victorious with sanity intact to plunder the digiverse in search of new and interesting challenges. For more information, or a quote, drop us an email and tell us what you're working on. </p> <p> &copy;2014 Sourcey <p> </footer> </body> </html> <script src="/javascripts/all.js"></script>